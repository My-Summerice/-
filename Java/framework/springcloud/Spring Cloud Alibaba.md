## Spring Cloud Alibaba

[toc]

### 1.注册配置中心

#### 1.1 服务注册与发现

​		**微服务：**简单来讲，微服务就是将传统的单体式应用系统按照一定的规则(一般来讲是按照功能)和颗粒度拆分成多个单独的模块作为一个服务进行部署，各模块内高内聚，模块间低耦合。这样操作后就能提升整个系统的可扩展性。

​		**问题：**但同时也会带来一个新的问题：原有的单体式应用模块间通讯只需要代码中的互相调用就可以了，而拆分成微服务后就需要考虑服务间的跨进程或是跨主机的通信，且要保证提供统一对外的服务调用能力。所以，Spring Cloud就来做这个事情。

​		**解决方案：**Spring Cloud在拆分后的微服务系统中引入了一个注册中心服务，在该系统中的其他服务启动时会将自身的**服务名称、主机IP、端口号**等信息发送到注册中心，在其他服务想要调用该服务时只需先来注册中心查找对应服务名称、ip、端口号等信息就可以进行调用。且能通过这个注册中心使整个微服务系统对外来讲像一个整体一样处理请求。

#### 1.2 配置管理

​		**传统配置管理：**一个普通的单体服务的配置管理一般都是由开发者编写一个配置文件与开发程序一同打包，具体的配置内容大家肯定都很熟悉，在此就不过多赘述了。

​		**问题：**传统的配置管理虽然在开发的时候较为方便快速，但是，仍旧存在一些问题，比如配置信息不易维护，每次变动可能要重新部署服务，尤其是当我们已经准备要开发一个微服务系统的时候，如果继续采用这种传统的配置管理方式，多个服务都需要做配置管理与维护，那会变得非常的不方便。

​		**解决方案：**在分布式架构系统（微服务）中，还会有一个统一管理各服务配置的配置中心服务，在这里我们采用 **Nacos** 平台去解决这些问题，它能够做到：

		- 管理应用程序配置
		- 环境隔离：如开发、测试、生产环境各需要的配置不同，可以在这里统一配置发布，很方便。
		- 提高程序安全性：像是一些敏感的配置信息直接放在程序里可能会有一定的风险，Nacos可以将配置加密且设置访问权限。
		- 动态更新配置：可在服务运行时发布，动态更新配置信息，无需重启服务。

Nacos的详细操作就不在这里展示了。

### 2.分布式事务

​		**分布式事务：**分布式事务指事务的参与者、支持事务的服务器、资源服务器以及事务管理器分别位于不同的分布式系统的不同节点之上。

​		**问题：**在采取分布式架构时，对于一次完整的业务操作，需要保证各服务中对数据的操作要么全部成功，要么全部失败（也就是常说的原子性操作），否则业务肯定会出现不可预估的问题。

​		**解决方案：**为了尽可能地保证这个分布式事务，我们通常采用 **Seata** 方案。同样，具体的操作就不再这里展示了。

### 3.限流降级

​		**限流降级：**对于一次业务请求，在一个微服务系统中可能存在很长的服务调用链，而当某个服务出现异常时可能会直接或间接的导致该链路上的其它服务不断地发起调用请求，最终导致服务器资源耗尽。为了避免这种情况发生，可以分别采取限流和降级两种方案来控制请求的频率。

​		**限流：**限流是指服务提供者对于特定接口或实例采取**访问次数限制**的操作。

​		**降级：**降级主要指在某服务出现**异常或限流**时，提供给使用者一个默认的数据或策略抑或是简化整个功能以保证整个系统的正常运行。

​		**解决方案：**Spring Cloud Alibaba 为了解决这种问题，采取了 **Sentinel** 方案。具体操作不赘述。

### 4.分布式消息

​		详见 **RocketMQ **。

### 5.异构服务

### 6.静态编译

### 7.最佳实践

​		SCA 的项目的最佳实践，是整合了 SCA 相关组件（Nacos，Sentinel，Seata，RocketMQ）的 Example 示例项目。方便用户全面体验 SCA 提供的一站式微服务解决方案。

```text
1. Spring Cloud Gateway：网关
2. Nacos：服务注册和配置中心
3. Sentinel：熔断限流
4. Seata：分布式事务
5. RocketMQ：消息队列，削峰填谷
6. Docker：使用Docker进行容器化部署
7. Kubernetes：使用k8s进行容器化部署
```

详见：

[](https://sca.aliyun.com/zh-cn/docs/2022.0.0.0/best-practice/spring-boot-to-spring-cloud)

